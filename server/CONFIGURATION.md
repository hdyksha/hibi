# サーバー設定ガイド

## 環境変数

サーバーの動作は環境変数でカスタマイズできます。

### 設定方法

1. プロジェクトルートで`.env.example`をコピーして`.env`ファイルを作成：

```bash
# プロジェクトルート（hibi/）で実行
cp .env.example .env
```

2. `.env`ファイルを編集して設定を変更

### 利用可能な環境変数

#### PORT
- **説明**: サーバーが起動するポート番号
- **デフォルト**: `3001`
- **例**: 
  ```
  PORT=8080
  ```

#### TODO_DATA_DIR
- **説明**: タスクデータを保存するJSONファイルのディレクトリパス
- **デフォルト**: `server/data`（プロジェクトルートからの相対パス）
- **形式**: プロジェクトルートディレクトリからの相対パス
- **例**:
  ```
  # デフォルト（server/dataディレクトリ）
  TODO_DATA_DIR=server/data
  
  # カスタムディレクトリを使用
  TODO_DATA_DIR=custom-data
  
  # 親ディレクトリの共有フォルダを使用
  TODO_DATA_DIR=../shared-todo-data
  ```

## 使用例

### 例1: 開発環境と本番環境で異なるディレクトリを使用

**開発環境 (.env.development)**
```bash
PORT=3001
TODO_DATA_DIR=server/data-dev
```

**本番環境 (.env.production)**
```bash
PORT=8080
TODO_DATA_DIR=server/data-prod
```

### 例2: 複数のプロジェクトで同じデータを共有

```bash
TODO_DATA_DIR=../../shared-todo-data
```

この設定により、複数のプロジェクトインスタンスが同じタスクデータにアクセスできます。

### 例3: ユーザーごとのデータディレクトリ

```bash
TODO_DATA_DIR=data-${USER}
```

注: 環境変数の展開はシェルレベルで行う必要があります。

## データディレクトリの構造

指定したディレクトリ内には、複数のJSONファイルを配置できます：

```
hibi/                        # プロジェクトルート
├── .env                     # 環境変数設定ファイル
└── server/
    └── data/                # デフォルトのデータディレクトリ
        ├── tasks.json           # デフォルトのタスクファイル
        ├── personal-tasks.json  # 個人用タスク
        ├── work-tasks.json      # 仕事用タスク
        └── project-tasks.json   # プロジェクト用タスク
```

アプリケーションのUIから、これらのファイルを切り替えて使用できます。

## セキュリティに関する注意

- `.env`ファイルは`.gitignore`に含まれており、Gitリポジトリにコミットされません
- 本番環境では、環境変数を直接設定することを推奨します
- データディレクトリへのアクセス権限を適切に設定してください

## トラブルシューティング

### ディレクトリが見つからないエラー

エラー: `Failed to read todos from storage`

**解決方法**:
1. 指定したディレクトリが存在することを確認
2. サーバーにディレクトリへの読み書き権限があることを確認
3. 相対パスが正しいことを確認

### ファイルが表示されない

**確認事項**:
1. ディレクトリ内に`.json`拡張子のファイルがあるか確認
2. JSONファイルの形式が正しいか確認（配列形式である必要があります）
3. ファイルの読み取り権限があるか確認
